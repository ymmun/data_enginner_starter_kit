1. 가상의 데이터 인프라 구축
  네이버 카페와 같은 커뮤니티 사이트를 운영한다고 가정해보았습니다.

  raw data :  1. 모든 회원의 정보 (아이디, 닉네임, 가입날짜, 회원등급)
              2. 날짜 별 회원들의 로그인 정보가 있는 로그
              3. 날짜 별 회원들이 게시글, 댓글을 작성한 정보가 있는 로그 (게시글의 제목, 내용과 같은 정보는 제외)
              4. 결제 로그
              5. 일자별 모든 회원들의 정보가 있으며, 해당 날짜 기준 회원의 상태가 저장되어 있는 테이블
                 (ex: a 유저의 가입날짜, 해당 날짜기준 회원등급, 최종 로그인 날짜, 최근 댓글 혹은 게시글 작성 시간, 가입 이후 접속한 날짜 횟수, 연속으로 접속한 날짜 횟수,
                      최근 일주일 접속한 횟수)
              6. 결제 로그를 집계하여 날짜별 모든 회원의 결제 상태를 나타내는 테이블. 무과금은 0원으로 표시
                 (ex: a 유저가 해당 날짜 기준 가입 이후 현재까지 결제한 금액, 당일 결제 금액, 최근 30일 결제 금액)


  analytics : 1. 시간대 별 게시글의 작성 개수를 나타내는 테이블
              2. 일자별 신규 유저, 액티브 유저, 휴면 유저(미접속 14일 이상) 를 나타내는 테이블 
              3. 일자별 가장 많이 팔린 top5 상품 목록과 개수를 나타내는 테이블
              4. 일자별 총 결제 금액



질문 : raw data 의 5, 6번 테이블은 1,2,3,4 의 정보를 이용하여 생성한 테이블입니다.
       해당 테이블들을 다시한번 집계하여  analytics 의 테이블이 생성이 되는데
       5, 6 번 테이블의 경우 raw data 에 있는게 더 옳은지 알 수 있을까요?
                
---------------------------------------------------------------------------------------------------


2. Monthly Active User


sql = '''
      SELECT ts, count(distinct userid) as cnt_userid
      FROM
      (
          SELECT userid, t1.sessionid, channel, to_char(ts, 'YYYY-mm') as ts
          FROM 
            raw_data.user_session_channel as t1
          JOIN
            raw_data.session_timestamp as t2
          on t1.sessionid = t2.sessionid
      ) as a
      GROUP BY ts
      ORDER BY 1
'''